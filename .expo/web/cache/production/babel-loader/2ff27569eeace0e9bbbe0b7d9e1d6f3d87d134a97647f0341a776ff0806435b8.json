{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.useAnimatedReaction=useAnimatedReaction;var _toConsumableArray2=_interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));var _react=require(\"react\");var _core=require(\"../core\");var _useSharedValue=require(\"./useSharedValue\");var _PlatformChecker=require(\"../PlatformChecker\");var _worklet_3805047105816_init_data={code:\"function anonymous(){const{prepare,react,previous}=this.__closure;const input=prepare();react(input,previous.value);previous.value=input;}\"};function useAnimatedReaction(prepare,react,dependencies){var _prepare$__closure;var previous=(0,_useSharedValue.useSharedValue)(null,true);var inputs=Object.values((_prepare$__closure=prepare.__closure)!=null?_prepare$__closure:{});if((0,_PlatformChecker.shouldBeUseWeb)()){var _dependencies;if(!inputs.length&&(_dependencies=dependencies)!==null&&_dependencies!==void 0&&_dependencies.length){inputs=dependencies;}}if(dependencies===undefined){var _prepare$__closure2,_react$__closure;dependencies=[].concat((0,_toConsumableArray2.default)(Object.values((_prepare$__closure2=prepare.__closure)!=null?_prepare$__closure2:{})),(0,_toConsumableArray2.default)(Object.values((_react$__closure=react.__closure)!=null?_react$__closure:{})),[prepare.__workletHash,react.__workletHash]);}else{dependencies.push(prepare.__workletHash,react.__workletHash);}(0,_react.useEffect)(function(){var fun=function(){var anonymous=function anonymous(){var input=prepare();react(input,previous.value);previous.value=input;};anonymous.__closure={prepare:prepare,react:react,previous:previous};anonymous.__initData=_worklet_3805047105816_init_data;anonymous.__workletHash=3805047105816;return anonymous;}();var mapperId=(0,_core.startMapper)(fun,inputs,[]);return function(){(0,_core.stopMapper)(mapperId);};},dependencies);}","map":{"version":3,"names":["_react","require","_core","_useSharedValue","_PlatformChecker","_worklet_3805047105816_init_data","code","useAnimatedReaction","prepare","react","dependencies","_prepare$__closure","previous","useSharedValue","inputs","Object","values","__closure","shouldBeUseWeb","_dependencies","length","undefined","_prepare$__closure2","_react$__closure","concat","_toConsumableArray2","default","__workletHash","push","useEffect","fun","anonymous","input","value","__initData","mapperId","startMapper","stopMapper"],"sources":["/Users/shayan/workspace/godfather/node_modules/react-native-reanimated/lib/module/reanimated2/hook/useAnimatedReaction.ts"],"sourcesContent":["import { useEffect } from 'react';\nimport type { __BasicWorkletFunction, __WorkletFunction } from '../commonTypes';\nimport { startMapper, stopMapper } from '../core';\nimport type { DependencyList } from './commonTypes';\nimport { useSharedValue } from './useSharedValue';\nimport { shouldBeUseWeb } from '../PlatformChecker';\n\nexport interface AnimatedReactionWorkletFunction<T> extends __WorkletFunction {\n  (prepared: T, previous: T | null): void;\n}\n/**\n * @param prepare - worklet used for data preparation for the second parameter\n * @param react - worklet which takes data prepared by the one in the first parameter and performs certain actions\n * the first worklet defines the inputs, in other words on which shared values change will it be called.\n * the second one can modify any shared values but those which are mentioned in the first worklet. Beware of that, because this may result in endless loop and high cpu usage.\n */\nexport function useAnimatedReaction<T>(\n  prepare: __BasicWorkletFunction<T>,\n  react: AnimatedReactionWorkletFunction<T>,\n  dependencies?: DependencyList\n): void {\n  const previous = useSharedValue<T | null>(null, true);\n\n  let inputs = Object.values(prepare.__closure ?? {});\n\n  if (shouldBeUseWeb()) {\n    if (!inputs.length && dependencies?.length) {\n      // let web work without a Babel/SWC plugin\n      inputs = dependencies;\n    }\n  }\n\n  if (dependencies === undefined) {\n    dependencies = [\n      ...Object.values(prepare.__closure ?? {}),\n      ...Object.values(react.__closure ?? {}),\n      prepare.__workletHash,\n      react.__workletHash,\n    ];\n  } else {\n    dependencies.push(prepare.__workletHash, react.__workletHash);\n  }\n\n  useEffect(() => {\n    const fun = () => {\n      'worklet';\n      const input = prepare();\n      react(input, previous.value);\n      previous.value = input;\n    };\n    const mapperId = startMapper(fun, inputs, []);\n    return () => {\n      stopMapper(mapperId);\n    };\n  }, dependencies);\n}\n"],"mappings":"gSAAA,IAAAA,MAAA,CAAAC,OAAA,UAEA,IAAAC,KAAA,CAAAD,OAAA,YAEA,IAAAE,eAAA,CAAAF,OAAA,qBACA,IAAAG,gBAAA,CAAAH,OAAA,uBAAmD,IAAAI,gCAAA,EAAAC,IAAA,+IAW5C,QAAS,CAAAC,mBAAmBA,CACjCC,OAAkC,CAClCC,KAAyC,CACzCC,YAA6B,CACvB,KAAAC,kBAAA,CACN,GAAM,CAAAC,QAAQ,CAAG,GAAAC,8BAAc,EAAW,IAAI,CAAE,IAAI,CAAC,CAErD,GAAI,CAAAC,MAAM,CAAGC,MAAM,CAACC,MAAM,EAAAL,kBAAA,CAACH,OAAO,CAACS,SAAS,QAAAN,kBAAA,CAAI,CAAC,CAAC,CAAC,CAEnD,GAAI,GAAAO,+BAAc,GAAE,CAAE,KAAAC,aAAA,CACpB,GAAI,CAACL,MAAM,CAACM,MAAM,GAAAD,aAAA,CAAIT,YAAY,UAAAS,aAAA,WAAZA,aAAA,CAAcC,MAAM,CAAE,CAE1CN,MAAM,CAAGJ,YAAY,CACvB,CACF,CAEA,GAAIA,YAAY,GAAKW,SAAS,CAAE,KAAAC,mBAAA,CAAAC,gBAAA,CAC9Bb,YAAY,IAAAc,MAAA,IAAAC,mBAAA,CAAAC,OAAA,EACPX,MAAM,CAACC,MAAM,EAAAM,mBAAA,CAACd,OAAO,CAACS,SAAS,QAAAK,mBAAA,CAAI,CAAC,CAAC,CAAC,KAAAG,mBAAA,CAAAC,OAAA,EACtCX,MAAM,CAACC,MAAM,EAAAO,gBAAA,CAACd,KAAK,CAACQ,SAAS,QAAAM,gBAAA,CAAI,CAAC,CAAC,CAAC,GACvCf,OAAO,CAACmB,aAAa,CACrBlB,KAAK,CAACkB,aAAa,EACpB,CACH,CAAC,IAAM,CACLjB,YAAY,CAACkB,IAAI,CAACpB,OAAO,CAACmB,aAAa,CAAElB,KAAK,CAACkB,aAAa,CAAC,CAC/D,CAEA,GAAAE,gBAAS,EAAC,UAAM,CACd,GAAM,CAAAC,GAAG,gBAAAC,SAAA,UAAAA,UAAA,CAAS,CAEhB,GAAM,CAAAC,KAAK,CAAGxB,OAAO,EAAE,CACvBC,KAAK,CAACuB,KAAK,CAAEpB,QAAQ,CAACqB,KAAK,CAAC,CAC5BrB,QAAQ,CAACqB,KAAK,CAAGD,KAAK,CACxB,CAAC,CAAAD,SAAA,CAAAd,SAAA,EAAAT,OAAA,CA/CIA,OAAa,CAAAC,KAAA,CAEtBA,KAAA,CAAAG,QAAA,CACAA,QAAS,EAAAmB,SAAA,CAAAG,UAAA,CAAA7B,gCAAA,CAAA0B,SAAA,CAAAJ,aAAA,sBAAAI,SAAA,IA4CJ,CACD,GAAM,CAAAI,QAAQ,CAAG,GAAAC,iBAAW,EAACN,GAAG,CAAEhB,MAAM,CAAE,EAAE,CAAC,CAC7C,MAAO,WAAM,CACX,GAAAuB,gBAAU,EAACF,QAAQ,CAAC,CACtB,CAAC,CACH,CAAC,CAAEzB,YAAY,CAAC,CAClB"},"metadata":{},"sourceType":"script","externalDependencies":[]}