{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.camera=camera;exports.imageLibrary=imageLibrary;var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _regenerator=_interopRequireDefault(require(\"@babel/runtime/regenerator\"));var DEFAULT_OPTIONS={mediaType:'photo',includeBase64:false,selectionLimit:1};function camera(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:DEFAULT_OPTIONS;var callback=arguments.length>1?arguments[1]:undefined;return new Promise(function(resolve){var result={errorCode:'camera_unavailable',errorMessage:'launchCamera is not supported for web yet'};if(callback)callback(result);resolve(result);});}function imageLibrary(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:DEFAULT_OPTIONS;var callback=arguments.length>1?arguments[1]:undefined;if(options.mediaType!=='photo'){var result={errorCode:'others',errorMessage:'For now, only photo mediaType is supported for web'};if(callback)callback(result);return Promise.resolve(result);}var input=document.createElement('input');input.style.display='none';input.setAttribute('type','file');input.setAttribute('accept',getWebMediaType(options.mediaType));if(options.selectionLimit>1){input.setAttribute('multiple','multiple');}document.body.appendChild(input);return new Promise(function(resolve){input.addEventListener('change',function _callee(){var img,_result,imgs,_result2;return _regenerator.default.async(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!input.files){_context.next=16;break;}if(!(options.selectionLimit<=1)){_context.next=10;break;}_context.next=4;return _regenerator.default.awrap(readFile(input.files[0],{includeBase64:options.includeBase64}));case 4:img=_context.sent;_result={assets:[img]};if(callback)callback(_result);resolve(_result);_context.next=16;break;case 10:_context.next=12;return _regenerator.default.awrap(Promise.all(Array.from(input.files).map(function(file){return readFile(file,{includeBase64:options.includeBase64});})));case 12:imgs=_context.sent;_result2={didCancel:false,assets:imgs};if(callback)callback(_result2);resolve(_result2);case 16:document.body.removeChild(input);case 17:case\"end\":return _context.stop();}},null,null,null,Promise);});var event=new MouseEvent('click');input.dispatchEvent(event);});}function readFile(targetFile,options){return new Promise(function(resolve,reject){var reader=new FileReader();reader.onerror=function(){reject(new Error(\"Failed to read the selected media because the operation failed.\"));};reader.onload=function(_ref){var target=_ref.target;var uri=target==null?void 0:target.result;var returnRaw=function returnRaw(){return resolve({uri:uri,width:0,height:0});};if(typeof uri==='string'){var image=new Image();image.src=uri;image.onload=function(){var _image$naturalWidth,_image$naturalHeight;return resolve((0,_extends2.default)({uri:uri,width:(_image$naturalWidth=image.naturalWidth)!=null?_image$naturalWidth:image.width,height:(_image$naturalHeight=image.naturalHeight)!=null?_image$naturalHeight:image.height},options.includeBase64&&{base64:uri.substr(uri.indexOf(',')+1)}));};image.onerror=function(){return returnRaw();};}else{returnRaw();}};reader.readAsDataURL(targetFile);});}function getWebMediaType(mediaType){var _webMediaTypes$mediaT;var webMediaTypes={photo:'image/*',video:'video/*',mixed:'image/*,video/*'};return(_webMediaTypes$mediaT=webMediaTypes[mediaType])!=null?_webMediaTypes$mediaT:webMediaTypes.photo;}","map":{"version":3,"names":["DEFAULT_OPTIONS","mediaType","includeBase64","selectionLimit","camera","options","arguments","length","undefined","callback","Promise","resolve","result","errorCode","errorMessage","imageLibrary","input","document","createElement","style","display","setAttribute","getWebMediaType","body","appendChild","addEventListener","_callee","img","_result","imgs","_result2","_regenerator","default","async","_callee$","_context","prev","next","files","awrap","readFile","sent","assets","all","Array","from","map","file","didCancel","removeChild","stop","event","MouseEvent","dispatchEvent","targetFile","reject","reader","FileReader","onerror","Error","onload","_ref","target","uri","returnRaw","width","height","image","Image","src","_image$naturalWidth","_image$naturalHeight","_extends2","naturalWidth","naturalHeight","base64","substr","indexOf","readAsDataURL","_webMediaTypes$mediaT","webMediaTypes","photo","video","mixed"],"sources":["/Users/shayan/workspace/godfather/node_modules/react-native-image-picker/src/platforms/web.ts"],"sourcesContent":["import {\n  CameraOptions,\n  ImageLibraryOptions,\n  Callback,\n  ImagePickerResponse,\n  ErrorCode,\n  Asset,\n  MediaType,\n} from '../types';\n\nconst DEFAULT_OPTIONS: Pick<\n  ImageLibraryOptions & CameraOptions,\n  'mediaType' | 'includeBase64' | 'selectionLimit'\n> = {\n  mediaType: 'photo',\n  includeBase64: false,\n  selectionLimit: 1,\n};\n\nexport function camera(\n  options: ImageLibraryOptions = DEFAULT_OPTIONS,\n  callback?: Callback,\n): Promise<ImagePickerResponse> {\n  return new Promise((resolve) => {\n    const result = {\n      errorCode: 'camera_unavailable' as ErrorCode,\n      errorMessage: 'launchCamera is not supported for web yet',\n    };\n\n    if (callback) callback(result);\n\n    resolve(result);\n  });\n}\n\nexport function imageLibrary(\n  options: ImageLibraryOptions = DEFAULT_OPTIONS,\n  callback?: Callback,\n): Promise<ImagePickerResponse> {\n  // Only supporting 'photo' mediaType for now.\n  if (options.mediaType !== 'photo') {\n    const result = {\n      errorCode: 'others' as ErrorCode,\n      errorMessage: 'For now, only photo mediaType is supported for web',\n    };\n\n    if (callback) callback(result);\n\n    return Promise.resolve(result);\n  }\n\n  const input = document.createElement('input');\n  input.style.display = 'none';\n  input.setAttribute('type', 'file');\n  input.setAttribute('accept', getWebMediaType(options.mediaType));\n\n  if (options.selectionLimit! > 1) {\n    input.setAttribute('multiple', 'multiple');\n  }\n\n  document.body.appendChild(input);\n\n  return new Promise((resolve) => {\n    input.addEventListener('change', async () => {\n      if (input.files) {\n        if (options.selectionLimit! <= 1) {\n          const img = await readFile(input.files[0], {\n            includeBase64: options.includeBase64,\n          });\n\n          const result = {assets: [img]};\n\n          if (callback) callback(result);\n\n          resolve(result);\n        } else {\n          const imgs = await Promise.all(\n            Array.from(input.files).map((file) =>\n              readFile(file, {includeBase64: options.includeBase64}),\n            ),\n          );\n\n          const result = {\n            didCancel: false,\n            assets: imgs,\n          };\n\n          if (callback) callback(result);\n\n          resolve(result);\n        }\n      }\n      document.body.removeChild(input);\n    });\n\n    const event = new MouseEvent('click');\n    input.dispatchEvent(event);\n  });\n}\n\nfunction readFile(\n  targetFile: Blob,\n  options: Partial<ImageLibraryOptions>,\n): Promise<Asset> {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onerror = () => {\n      reject(\n        new Error(\n          `Failed to read the selected media because the operation failed.`,\n        ),\n      );\n    };\n    reader.onload = ({target}) => {\n      const uri = target?.result;\n\n      const returnRaw = () =>\n        resolve({\n          uri: uri as string,\n          width: 0,\n          height: 0,\n        });\n\n      if (typeof uri === 'string') {\n        const image = new Image();\n        image.src = uri;\n        image.onload = () =>\n          resolve({\n            uri,\n            width: image.naturalWidth ?? image.width,\n            height: image.naturalHeight ?? image.height,\n            // The blob's result cannot be directly decoded as Base64 without\n            // first removing the Data-URL declaration preceding the\n            // Base64-encoded data. To retrieve only the Base64 encoded string,\n            // first remove data:*/*;base64, from the result.\n            // https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsDataURL\n            ...(options.includeBase64 && {\n              base64: uri.substr(uri.indexOf(',') + 1),\n            }),\n          });\n        image.onerror = () => returnRaw();\n      } else {\n        returnRaw();\n      }\n    };\n\n    reader.readAsDataURL(targetFile);\n  });\n}\n\nfunction getWebMediaType(mediaType: MediaType) {\n  const webMediaTypes = {\n    photo: 'image/*',\n    video: 'video/*',\n    mixed: 'image/*,video/*',\n  };\n\n  return webMediaTypes[mediaType] ?? webMediaTypes.photo;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}