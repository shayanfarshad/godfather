{"ast":null,"code":"Object.defineProperty(exports,\"__esModule\",{value:true});exports.useAnimatedRef=useAnimatedRef;var _react=require(\"react\");var _useSharedValue=require(\"./useSharedValue\");var _NativeMethods=require(\"../NativeMethods\");var _fabricUtils=require(\"../fabricUtils\");var _shareables=require(\"../shareables\");function getShareableShadowNodeFromComponent(component){return(0,_fabricUtils.getShadowNodeWrapperFromHostInstance)(component);}function getComponentOrScrollableRef(component){if(global._IS_FABRIC&&component.getNativeScrollRef){return component.getNativeScrollRef();}else if(!global._IS_FABRIC&&component.getScrollableNode){return component.getScrollableNode();}return component;}var getTagValueFunction=global._IS_FABRIC?getShareableShadowNodeFromComponent:_NativeMethods.getTag;var _worklet_14499715267282_init_data={code:\"function anonymous(){const{tag}=this._closure;return function(){return tag.value;};}\",location:\"node_modules/react-native-reanimated/lib/module/reanimated2/hook/useAnimatedRef.js\"};function useAnimatedRef(){var tag=(0,_useSharedValue.useSharedValue)(-1);var ref=(0,_react.useRef)();if(!ref.current){var fun=function fun(component){if(component){tag.value=getTagValueFunction(getComponentOrScrollableRef(component));fun.current=component;}return tag.value;};fun.current=null;var remoteRef=(0,_shareables.makeShareableCloneRecursive)({__init:function(){var _f=function _f(){return function(){return tag.value;};};_f._closure={tag:tag};_f.__initData=_worklet_14499715267282_init_data;_f.__workletHash=14499715267282;return _f;}()});(0,_shareables.registerShareableMapping)(fun,remoteRef);ref.current=fun;}return ref.current;}","map":{"version":3,"names":["_react","require","_useSharedValue","_NativeMethods","_fabricUtils","_shareables","getShareableShadowNodeFromComponent","component","getShadowNodeWrapperFromHostInstance","getComponentOrScrollableRef","global","_IS_FABRIC","getNativeScrollRef","getScrollableNode","getTagValueFunction","getTag","_worklet_14499715267282_init_data","code","location","useAnimatedRef","tag","useSharedValue","ref","useRef","current","fun","value","remoteRef","makeShareableCloneRecursive","__init","_f","_closure","__initData","__workletHash","registerShareableMapping"],"sources":["/Users/shayan/workspace/godfather/node_modules/react-native-reanimated/lib/module/reanimated2/hook/useAnimatedRef.ts"],"sourcesContent":["import { Component, useRef } from 'react';\nimport { useSharedValue } from './useSharedValue';\nimport { RefObjectFunction } from './commonTypes';\nimport { ShadowNodeWrapper } from '../commonTypes';\nimport { getTag } from '../NativeMethods';\nimport { getShadowNodeWrapperFromHostInstance } from '../fabricUtils';\nimport {\n  makeShareableCloneRecursive,\n  registerShareableMapping,\n} from '../shareables';\n\ninterface ComponentRef extends Component {\n  getNativeScrollRef?: () => ComponentRef;\n  getScrollableNode?: () => ComponentRef;\n}\n\nfunction getShareableShadowNodeFromComponent(\n  component: ComponentRef\n): ShadowNodeWrapper {\n  return getShadowNodeWrapperFromHostInstance(component);\n}\n\nfunction getComponentOrScrollableRef(component: ComponentRef): ComponentRef {\n  if (global._IS_FABRIC && component.getNativeScrollRef) {\n    return component.getNativeScrollRef();\n  } else if (!global._IS_FABRIC && component.getScrollableNode) {\n    return component.getScrollableNode();\n  }\n  return component;\n}\n\nconst getTagValueFunction = global._IS_FABRIC\n  ? getShareableShadowNodeFromComponent\n  : getTag;\n\nexport function useAnimatedRef<T extends ComponentRef>(): RefObjectFunction<T> {\n  const tag = useSharedValue<number | ShadowNodeWrapper | null>(-1);\n  const ref = useRef<RefObjectFunction<T>>();\n\n  if (!ref.current) {\n    const fun: RefObjectFunction<T> = <RefObjectFunction<T>>((component) => {\n      // enters when ref is set by attaching to a component\n      if (component) {\n        tag.value = getTagValueFunction(getComponentOrScrollableRef(component));\n        fun.current = component;\n      }\n      return tag.value;\n    });\n\n    fun.current = null;\n\n    const remoteRef = makeShareableCloneRecursive({\n      __init: () => {\n        'worklet';\n        return () => tag.value;\n      },\n    });\n    registerShareableMapping(fun, remoteRef);\n    ref.current = fun;\n  }\n\n  return ref.current;\n}\n"],"mappings":"+FAAA,IAAAA,MAAA,CAAAC,OAAA,UACA,IAAAC,eAAA,CAAAD,OAAA,qBAGA,IAAAE,cAAA,CAAAF,OAAA,qBACA,IAAAG,YAAA,CAAAH,OAAA,mBACA,IAAAI,WAAA,CAAAJ,OAAA,kBAUA,QAAS,CAAAK,mCAAmCA,CAC1CC,SAAuB,CACJ,CACnB,MAAO,GAAAC,iDAAoC,EAACD,SAAS,CAAC,CACxD,CAEA,QAAS,CAAAE,2BAA2BA,CAACF,SAAuB,CAAgB,CAC1E,GAAIG,MAAM,CAACC,UAAU,EAAIJ,SAAS,CAACK,kBAAkB,CAAE,CACrD,MAAO,CAAAL,SAAS,CAACK,kBAAkB,EAAE,CACvC,CAAC,IAAM,IAAI,CAACF,MAAM,CAACC,UAAU,EAAIJ,SAAS,CAACM,iBAAiB,CAAE,CAC5D,MAAO,CAAAN,SAAS,CAACM,iBAAiB,EAAE,CACtC,CACA,MAAO,CAAAN,SAAS,CAClB,CAEA,GAAM,CAAAO,mBAAmB,CAAGJ,MAAM,CAACC,UAAU,CACzCL,mCAAmC,CACnCS,qBAAM,KAAAC,iCAAA,EAAAC,IAAA,wFAAAC,QAAA,uFAEH,QAAS,CAAAC,cAAcA,CAAA,CAAiD,CAC7E,GAAM,CAAAC,GAAG,CAAG,GAAAC,8BAAc,EAAoC,CAAC,CAAC,CAAC,CACjE,GAAM,CAAAC,GAAG,CAAG,GAAAC,aAAM,GAAwB,CAE1C,GAAI,CAACD,GAAG,CAACE,OAAO,CAAE,CAChB,GAAM,CAAAC,GAAyB,CAA2B,QAApD,CAAAA,GAAyBA,CAA2BlB,SAAS,CAAK,CAEtE,GAAIA,SAAS,CAAE,CACba,GAAG,CAACM,KAAK,CAAGZ,mBAAmB,CAACL,2BAA2B,CAACF,SAAS,CAAC,CAAC,CACvEkB,GAAG,CAACD,OAAO,CAAGjB,SAAS,CACzB,CACA,MAAO,CAAAa,GAAG,CAACM,KAAK,CAClB,CAAE,CAEFD,GAAG,CAACD,OAAO,CAAG,IAAI,CAElB,GAAM,CAAAG,SAAS,CAAG,GAAAC,uCAA2B,EAAC,CAC5CC,MAAM,gBAAAC,EAAA,UAAAA,GAAA,CAAQ,CAEZ,MAAO,kBAAM,CAAAV,GAAG,CAACM,KAAK,GACxB,EAAAI,EAAA,CAAAC,QAAA,EAAAX,GAAA,CAtDGA,GAAA,EAAAU,EAAA,CAAAE,UAAA,CAAAhB,iCAAA,CAAAc,EAAA,CAAAG,aAAA,uBAAAH,EAAA,IAuDL,CAAC,CAAC,CACF,GAAAI,oCAAwB,EAACT,GAAG,CAAEE,SAAS,CAAC,CACxCL,GAAG,CAACE,OAAO,CAAGC,GAAG,CACnB,CAEA,MAAO,CAAAH,GAAG,CAACE,OAAO,CACpB"},"metadata":{},"sourceType":"script","externalDependencies":[]}