{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));var _createClass2=_interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _NativeReanimated=_interopRequireDefault(require(\"./NativeReanimated\"));var _core=require(\"./core\");function _defineProperty(obj,key,value){key=_toPropertyKey(key);if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}function _toPropertyKey(arg){var key=_toPrimitive(arg,\"string\");return typeof key===\"symbol\"?key:String(key);}function _toPrimitive(input,hint){if(typeof input!==\"object\"||input===null)return input;var prim=input[Symbol.toPrimitive];if(prim!==undefined){var res=prim.call(input,hint||\"default\");if(typeof res!==\"object\")return res;throw new TypeError(\"@@toPrimitive must return a primitive value.\");}return(hint===\"string\"?String:Number)(input);}function jsListener(eventName,handler){return function(evt){handler((0,_extends2.default)({},evt.nativeEvent,{eventName:eventName}));};}var WorkletEventHandler=exports.default=function(){function WorkletEventHandler(worklet){(0,_classCallCheck2.default)(this,WorkletEventHandler);var eventNames=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_defineProperty(this,\"worklet\",void 0);_defineProperty(this,\"eventNames\",void 0);_defineProperty(this,\"reattachNeeded\",void 0);_defineProperty(this,\"listeners\",void 0);_defineProperty(this,\"viewTag\",void 0);_defineProperty(this,\"registrations\",void 0);this.worklet=worklet;this.eventNames=eventNames;this.reattachNeeded=false;this.listeners={};this.viewTag=undefined;this.registrations=[];if(!_NativeReanimated.default.native){this.listeners=eventNames.reduce(function(acc,eventName){acc[eventName]=jsListener(eventName,worklet);return acc;},{});}}(0,_createClass2.default)(WorkletEventHandler,[{key:\"updateWorklet\",value:function updateWorklet(newWorklet){this.worklet=newWorklet;this.reattachNeeded=true;}},{key:\"registerForEvents\",value:function registerForEvents(viewTag,fallbackEventName){var _this=this;this.viewTag=viewTag;this.registrations=this.eventNames.map(function(eventName){return(0,_core.registerEventHandler)(viewTag+eventName,_this.worklet);});if(this.registrations.length===0&&fallbackEventName){this.registrations.push((0,_core.registerEventHandler)(viewTag+fallbackEventName,this.worklet));}}},{key:\"unregisterFromEvents\",value:function unregisterFromEvents(){this.registrations.forEach(function(id){return(0,_core.unregisterEventHandler)(id);});this.registrations=[];}}]);return WorkletEventHandler;}();","map":{"version":3,"names":["_NativeReanimated","_interopRequireDefault","require","_core","jsListener","eventName","handler","evt","_extends2","default","nativeEvent","WorkletEventHandler","exports","worklet","_classCallCheck2","eventNames","arguments","length","undefined","_defineProperty","reattachNeeded","listeners","viewTag","registrations","NativeReanimatedModule","native","reduce","acc","_createClass2","key","value","updateWorklet","newWorklet","registerForEvents","fallbackEventName","_this","map","registerEventHandler","push","unregisterFromEvents","forEach","id","unregisterEventHandler"],"sources":["/Users/shayan/workspace/godfather/node_modules/react-native-reanimated/lib/module/reanimated2/WorkletEventHandler.ts"],"sourcesContent":["import { NativeEvent } from './commonTypes';\nimport NativeReanimatedModule from './NativeReanimated';\nimport { registerEventHandler, unregisterEventHandler } from './core';\n\nfunction jsListener<T extends NativeEvent<T>>(\n  eventName: string,\n  handler: (event: T) => void\n) {\n  return (evt: T) => {\n    handler({ ...evt.nativeEvent, eventName });\n  };\n}\n\nexport default class WorkletEventHandler<T extends NativeEvent<T>> {\n  worklet: (event: T) => void;\n  eventNames: string[];\n  reattachNeeded: boolean;\n  listeners: Record<string, (event: T) => void>;\n  viewTag: number | undefined;\n  registrations: string[];\n  constructor(worklet: (event: T) => void, eventNames: string[] = []) {\n    this.worklet = worklet;\n    this.eventNames = eventNames;\n    this.reattachNeeded = false;\n    this.listeners = {};\n    this.viewTag = undefined;\n    this.registrations = [];\n\n    if (!NativeReanimatedModule.native) {\n      this.listeners = eventNames.reduce(\n        (acc: Record<string, (event: T) => void>, eventName: string) => {\n          acc[eventName] = jsListener(eventName, worklet);\n          return acc;\n        },\n        {}\n      );\n    }\n  }\n\n  updateWorklet(newWorklet: (event: T) => void): void {\n    this.worklet = newWorklet;\n    this.reattachNeeded = true;\n  }\n\n  registerForEvents(viewTag: number, fallbackEventName?: string): void {\n    this.viewTag = viewTag;\n    this.registrations = this.eventNames.map((eventName) =>\n      registerEventHandler(viewTag + eventName, this.worklet)\n    );\n    if (this.registrations.length === 0 && fallbackEventName) {\n      this.registrations.push(\n        registerEventHandler(viewTag + fallbackEventName, this.worklet)\n      );\n    }\n  }\n\n  unregisterFromEvents(): void {\n    this.registrations.forEach((id) => unregisterEventHandler(id));\n    this.registrations = [];\n  }\n}\n"],"mappings":"yaACA,IAAAA,iBAAA,CAAAC,sBAAA,CAAAC,OAAA,wBACA,IAAAC,KAAA,CAAAD,OAAA,W,4oBAEA,QAAS,CAAAE,UAAUA,CACjBC,SAAiB,CACjBC,OAA2B,CAC3B,CACA,MAAQ,UAAAC,GAAM,CAAK,CACjBD,OAAO,IAAAE,SAAA,CAAAC,OAAA,KAAMF,GAAG,CAACG,WAAW,EAAEL,SAAA,CAAAA,SAAA,EAAW,CAAC,CAC5C,CAAC,CACH,IAEqB,CAAAM,mBAAmB,CAAAC,OAAA,CAAAH,OAAA,YAOtC,SAAAE,oBAAYE,OAA2B,CAA6B,IAAAC,gBAAA,CAAAL,OAAA,OAAAE,mBAAA,KAA3B,CAAAI,UAAoB,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAG,EAAE,CAAAG,eAAA,wBAAAA,eAAA,2BAAAA,eAAA,+BAAAA,eAAA,0BAAAA,eAAA,wBAAAA,eAAA,8BAChE,IAAI,CAACN,OAAO,CAAGA,OAAO,CACtB,IAAI,CAACE,UAAU,CAAGA,UAAU,CAC5B,IAAI,CAACK,cAAc,CAAG,KAAK,CAC3B,IAAI,CAACC,SAAS,CAAG,CAAC,CAAC,CACnB,IAAI,CAACC,OAAO,CAAGJ,SAAS,CACxB,IAAI,CAACK,aAAa,CAAG,EAAE,CAEvB,GAAI,CAACC,yBAAsB,CAACC,MAAM,CAAE,CAClC,IAAI,CAACJ,SAAS,CAAGN,UAAU,CAACW,MAAM,CAChC,SAACC,GAAuC,CAAEtB,SAAiB,CAAK,CAC9DsB,GAAG,CAACtB,SAAS,CAAC,CAAGD,UAAU,CAACC,SAAS,CAAEQ,OAAO,CAAC,CAC/C,MAAO,CAAAc,GAAG,CACZ,CAAC,CACD,CAAC,CAAC,CACH,CACH,CACF,IAAAC,aAAA,CAAAnB,OAAA,EAAAE,mBAAA,GAAAkB,GAAA,iBAAAC,KAAA,CAEA,SAAAC,cAAcC,UAA8B,CAAQ,CAClD,IAAI,CAACnB,OAAO,CAAGmB,UAAU,CACzB,IAAI,CAACZ,cAAc,CAAG,IAAI,CAC5B,IAAAS,GAAA,qBAAAC,KAAA,CAEA,SAAAG,kBAAkBX,OAAe,CAAEY,iBAA0B,CAAQ,KAAAC,KAAA,MACnE,IAAI,CAACb,OAAO,CAAGA,OAAO,CACtB,IAAI,CAACC,aAAa,CAAG,IAAI,CAACR,UAAU,CAACqB,GAAG,CAAE,SAAA/B,SAAS,QACjD,GAAAgC,0BAAoB,EAACf,OAAO,CAAGjB,SAAS,CAAE8B,KAAI,CAACtB,OAAO,CAAC,GACxD,CACD,GAAI,IAAI,CAACU,aAAa,CAACN,MAAM,GAAK,CAAC,EAAIiB,iBAAiB,CAAE,CACxD,IAAI,CAACX,aAAa,CAACe,IAAI,CACrB,GAAAD,0BAAoB,EAACf,OAAO,CAAGY,iBAAiB,CAAE,IAAI,CAACrB,OAAO,CAAC,CAChE,CACH,CACF,IAAAgB,GAAA,wBAAAC,KAAA,CAEA,SAAAS,qBAAA,CAA6B,CAC3B,IAAI,CAAChB,aAAa,CAACiB,OAAO,CAAE,SAAAC,EAAE,QAAK,GAAAC,4BAAsB,EAACD,EAAE,CAAC,GAAC,CAC9D,IAAI,CAAClB,aAAa,CAAG,EAAE,CACzB,YAAAZ,mBAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}