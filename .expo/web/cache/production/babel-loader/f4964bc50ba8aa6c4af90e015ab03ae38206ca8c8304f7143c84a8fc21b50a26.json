{"ast":null,"code":"var _interopRequireDefault=require(\"@babel/runtime/helpers/interopRequireDefault\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.callGuardDEV=void 0;exports.initializeUIRuntime=initializeUIRuntime;exports.setupConsole=exports.setupCallGuard=void 0;var _extends2=_interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));var _errors=require(\"./errors\");var _PlatformChecker=require(\"./PlatformChecker\");var _threads=require(\"./threads\");var _utils=require(\"./utils\");var IS_JEST=(0,_PlatformChecker.isJest)();var IS_NATIVE=!(0,_PlatformChecker.shouldBeUseWeb)();var IS_CHROME_DEBUGGER=(0,_PlatformChecker.isChromeDebugger)();var _worklet_14810700639596_init_data={code:\"function callGuardDEV(fn){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}try{fn(...args);}catch(e){if(global.__ErrorUtils){global.__ErrorUtils.reportFatalError(e);}else{throw e;}}}\"};var callGuardDEV=exports.callGuardDEV=function(){var callGuardDEV=function callGuardDEV(fn){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key];}try{fn.apply(void 0,args);}catch(e){if(global.__ErrorUtils){global.__ErrorUtils.reportFatalError(e);}else{throw e;}}};callGuardDEV.__closure={};callGuardDEV.__initData=_worklet_14810700639596_init_data;callGuardDEV.__workletHash=14810700639596;return callGuardDEV;}();var _worklet_5000844547961_init_data={code:\"function setupCallGuard(){const{callGuardDEV,runOnJS,reportFatalErrorOnJS}=this.__closure;global.__callGuardDEV=callGuardDEV;global.__ErrorUtils={reportFatalError:function(error){runOnJS(reportFatalErrorOnJS)({message:error.message,stack:error.stack});}};}\"};var setupCallGuard=exports.setupCallGuard=function(){var setupCallGuard=function setupCallGuard(){global.__callGuardDEV=callGuardDEV;global.__ErrorUtils={reportFatalError:function reportFatalError(error){(0,_threads.runOnJS)(_errors.reportFatalErrorOnJS)({message:error.message,stack:error.stack});}};};setupCallGuard.__closure={callGuardDEV:callGuardDEV,runOnJS:_threads.runOnJS,reportFatalErrorOnJS:_errors.reportFatalErrorOnJS};setupCallGuard.__initData=_worklet_5000844547961_init_data;setupCallGuard.__workletHash=5000844547961;return setupCallGuard;}();var capturableConsole=(0,_extends2.default)({},console);var _worklet_3852058212244_init_data={code:\"function setupConsole(){const{IS_CHROME_DEBUGGER,runOnJS,capturableConsole}=this.__closure;if(!IS_CHROME_DEBUGGER){global.console={assert:runOnJS(capturableConsole.assert),debug:runOnJS(capturableConsole.debug),log:runOnJS(capturableConsole.log),warn:runOnJS(capturableConsole.warn),error:runOnJS(capturableConsole.error),info:runOnJS(capturableConsole.info)};}}\"};var setupConsole=exports.setupConsole=function(){var setupConsole=function setupConsole(){if(!IS_CHROME_DEBUGGER){global.console={assert:(0,_threads.runOnJS)(capturableConsole.assert),debug:(0,_threads.runOnJS)(capturableConsole.debug),log:(0,_threads.runOnJS)(capturableConsole.log),warn:(0,_threads.runOnJS)(capturableConsole.warn),error:(0,_threads.runOnJS)(capturableConsole.error),info:(0,_threads.runOnJS)(capturableConsole.info)};}};setupConsole.__closure={IS_CHROME_DEBUGGER:IS_CHROME_DEBUGGER,runOnJS:_threads.runOnJS,capturableConsole:capturableConsole};setupConsole.__initData=_worklet_3852058212244_init_data;setupConsole.__workletHash=3852058212244;return setupConsole;}();var _worklet_7781445156117_init_data={code:\"function setupRequestAnimationFrame(){const{callMicrotasks}=this.__closure;const nativeRequestAnimationFrame=global.requestAnimationFrame;let animationFrameCallbacks=[];let lastNativeAnimationFrameTimestamp=-1;global.__flushAnimationFrame=function(frameTimestamp){const currentCallbacks=animationFrameCallbacks;animationFrameCallbacks=[];currentCallbacks.forEach(function(f){return f(frameTimestamp);});callMicrotasks();};global.requestAnimationFrame=function(callback){animationFrameCallbacks.push(callback);if(animationFrameCallbacks.length===1){nativeRequestAnimationFrame(function(timestamp){if(lastNativeAnimationFrameTimestamp>=timestamp){return;}lastNativeAnimationFrameTimestamp=timestamp;global.__frameTimestamp=timestamp;global.__flushAnimationFrame(timestamp);global.__frameTimestamp=undefined;});}return-1;};}\"};var setupRequestAnimationFrame=function(){var setupRequestAnimationFrame=function setupRequestAnimationFrame(){var nativeRequestAnimationFrame=global.requestAnimationFrame;var animationFrameCallbacks=[];var lastNativeAnimationFrameTimestamp=-1;global.__flushAnimationFrame=function(frameTimestamp){var currentCallbacks=animationFrameCallbacks;animationFrameCallbacks=[];currentCallbacks.forEach(function(f){return f(frameTimestamp);});(0,_threads.callMicrotasks)();};global.requestAnimationFrame=function(callback){animationFrameCallbacks.push(callback);if(animationFrameCallbacks.length===1){nativeRequestAnimationFrame(function(timestamp){if(lastNativeAnimationFrameTimestamp>=timestamp){return;}lastNativeAnimationFrameTimestamp=timestamp;global.__frameTimestamp=timestamp;global.__flushAnimationFrame(timestamp);global.__frameTimestamp=undefined;});}return-1;};};setupRequestAnimationFrame.__closure={callMicrotasks:_threads.callMicrotasks};setupRequestAnimationFrame.__initData=_worklet_7781445156117_init_data;setupRequestAnimationFrame.__workletHash=7781445156117;return setupRequestAnimationFrame;}();var _worklet_57184292613_init_data={code:\"function anonymous(){const{setupCallGuard,setupConsole,IS_NATIVE,setupMicrotasks,setupRequestAnimationFrame}=this.__closure;setupCallGuard();setupConsole();if(IS_NATIVE){setupMicrotasks();setupRequestAnimationFrame();}}\"};function initializeUIRuntime(){if(IS_JEST){globalThis.requestAnimationFrame=_utils.mockedRequestAnimationFrame;}(0,_threads.runOnUIImmediately)(function(){var anonymous=function anonymous(){setupCallGuard();setupConsole();if(IS_NATIVE){(0,_threads.setupMicrotasks)();setupRequestAnimationFrame();}};anonymous.__closure={setupCallGuard:setupCallGuard,setupConsole:setupConsole,IS_NATIVE:IS_NATIVE,setupMicrotasks:_threads.setupMicrotasks,setupRequestAnimationFrame:setupRequestAnimationFrame};anonymous.__initData=_worklet_57184292613_init_data;anonymous.__workletHash=57184292613;return anonymous;}())();}","map":{"version":3,"names":["_errors","require","_PlatformChecker","_threads","_utils","IS_JEST","isJest","IS_NATIVE","shouldBeUseWeb","IS_CHROME_DEBUGGER","isChromeDebugger","_worklet_14810700639596_init_data","code","callGuardDEV","exports","fn","_len","arguments","length","args","Array","_key","apply","e","global","__ErrorUtils","reportFatalError","__closure","__initData","__workletHash","_worklet_5000844547961_init_data","setupCallGuard","__callGuardDEV","error","runOnJS","reportFatalErrorOnJS","message","stack","capturableConsole","_extends2","default","console","_worklet_3852058212244_init_data","setupConsole","assert","debug","log","warn","info","_worklet_7781445156117_init_data","setupRequestAnimationFrame","nativeRequestAnimationFrame","requestAnimationFrame","animationFrameCallbacks","lastNativeAnimationFrameTimestamp","__flushAnimationFrame","frameTimestamp","currentCallbacks","forEach","f","callMicrotasks","callback","push","timestamp","__frameTimestamp","undefined","_worklet_57184292613_init_data","initializeUIRuntime","globalThis","mockedRequestAnimationFrame","runOnUIImmediately","anonymous","setupMicrotasks"],"sources":["/Users/shayan/workspace/godfather/node_modules/react-native-reanimated/lib/module/reanimated2/initializers.ts"],"sourcesContent":["import { reportFatalErrorOnJS } from './errors';\nimport { isChromeDebugger, isJest, shouldBeUseWeb } from './PlatformChecker';\nimport {\n  runOnJS,\n  setupMicrotasks,\n  callMicrotasks,\n  runOnUIImmediately,\n} from './threads';\nimport { mockedRequestAnimationFrame } from './utils';\n\nconst IS_JEST = isJest();\nconst IS_NATIVE = !shouldBeUseWeb();\nconst IS_CHROME_DEBUGGER = isChromeDebugger();\n\n// callGuard is only used with debug builds\nexport function callGuardDEV<T extends Array<unknown>, U>(\n  fn: (...args: T) => U,\n  ...args: T\n): void {\n  'worklet';\n  try {\n    fn(...args);\n  } catch (e) {\n    if (global.__ErrorUtils) {\n      global.__ErrorUtils.reportFatalError(e as Error);\n    } else {\n      throw e;\n    }\n  }\n}\n\nexport function setupCallGuard() {\n  'worklet';\n  global.__callGuardDEV = callGuardDEV;\n  global.__ErrorUtils = {\n    reportFatalError: (error: Error) => {\n      runOnJS(reportFatalErrorOnJS)({\n        message: error.message,\n        stack: error.stack,\n      });\n    },\n  };\n}\n\n// We really have to create a copy of console here. Function runOnJS we use on elements inside\n// this object makes it not configurable\nconst capturableConsole = { ...console };\n\nexport function setupConsole() {\n  'worklet';\n  if (!IS_CHROME_DEBUGGER) {\n    // @ts-ignore TypeScript doesn't like that there are missing methods in console object, but we don't provide all the methods for the UI runtime console version\n    global.console = {\n      assert: runOnJS(capturableConsole.assert),\n      debug: runOnJS(capturableConsole.debug),\n      log: runOnJS(capturableConsole.log),\n      warn: runOnJS(capturableConsole.warn),\n      error: runOnJS(capturableConsole.error),\n      info: runOnJS(capturableConsole.info),\n    };\n  }\n}\n\nfunction setupRequestAnimationFrame() {\n  'worklet';\n\n  // Jest mocks requestAnimationFrame API and it does not like if that mock gets overridden\n  // so we avoid doing requestAnimationFrame batching in Jest environment.\n  const nativeRequestAnimationFrame = global.requestAnimationFrame;\n\n  let animationFrameCallbacks: Array<(timestamp: number) => void> = [];\n  let lastNativeAnimationFrameTimestamp = -1;\n\n  global.__flushAnimationFrame = (frameTimestamp: number) => {\n    const currentCallbacks = animationFrameCallbacks;\n    animationFrameCallbacks = [];\n    currentCallbacks.forEach((f) => f(frameTimestamp));\n    callMicrotasks();\n  };\n\n  global.requestAnimationFrame = (\n    callback: (timestamp: number) => void\n  ): number => {\n    animationFrameCallbacks.push(callback);\n    if (animationFrameCallbacks.length === 1) {\n      // We schedule native requestAnimationFrame only when the first callback\n      // is added and then use it to execute all the enqueued callbacks. Once\n      // the callbacks are run, we clear the array.\n      nativeRequestAnimationFrame((timestamp) => {\n        if (lastNativeAnimationFrameTimestamp >= timestamp) {\n          // Make sure we only execute the callbacks once for a given frame\n          return;\n        }\n        lastNativeAnimationFrameTimestamp = timestamp;\n        global.__frameTimestamp = timestamp;\n        global.__flushAnimationFrame(timestamp);\n        global.__frameTimestamp = undefined;\n      });\n    }\n    // Reanimated currently does not support cancelling callbacks requested with\n    // requestAnimationFrame. We return -1 as identifier which isn't in line\n    // with the spec but it should give users better clue in case they actually\n    // attempt to store the value returned from rAF and use it for cancelling.\n    return -1;\n  };\n}\n\nexport function initializeUIRuntime() {\n  if (IS_JEST) {\n    // requestAnimationFrame react-native jest's setup is incorrect as it polyfills\n    // the method directly using setTimeout, therefore the callback doesn't get the\n    // expected timestamp as the only argument: https://github.com/facebook/react-native/blob/main/packages/react-native/jest/setup.js#L28\n    // We override this setup here to make sure that callbacks get the proper timestamps\n    // when executed. For non-jest environments we define requestAnimationFrame in setupRequestAnimationFrame\n    // @ts-ignore TypeScript uses Node definition for rAF, setTimeout, etc which returns a Timeout object rather than a number\n    globalThis.requestAnimationFrame = mockedRequestAnimationFrame;\n  }\n\n  runOnUIImmediately(() => {\n    'worklet';\n    setupCallGuard();\n    setupConsole();\n    if (IS_NATIVE) {\n      setupMicrotasks();\n      setupRequestAnimationFrame();\n    }\n  })();\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}