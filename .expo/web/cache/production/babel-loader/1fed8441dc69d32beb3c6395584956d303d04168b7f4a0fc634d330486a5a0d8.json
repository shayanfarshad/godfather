{"ast":null,"code":"Object.defineProperty(exports,\"__esModule\",{value:true});exports.useAnimatedRef=useAnimatedRef;var _react=require(\"react\");var _useSharedValue=require(\"./useSharedValue\");var _fabricUtils=require(\"../fabricUtils\");var _shareables=require(\"../shareables\");var _reactNative=require(\"react-native\");function getComponentOrScrollable(component){if(global._IS_FABRIC&&component.getNativeScrollRef){return component.getNativeScrollRef();}else if(!global._IS_FABRIC&&component.getScrollableNode){return component.getScrollableNode();}return component;}var getTagValueFunction=global._IS_FABRIC?_fabricUtils.getShadowNodeWrapperFromRef:_reactNative.findNodeHandle;var _worklet_10709902486534_init_data={code:\"function anonymous(){const{tag,viewName}=this.__closure;const f=function(){return tag.value;};f.viewName=viewName;return f;}\"};function useAnimatedRef(){var tag=(0,_useSharedValue.useSharedValue)(-1);var viewName=(0,_useSharedValue.useSharedValue)(null);var ref=(0,_react.useRef)();if(!ref.current){var fun=function fun(component){if(component){tag.value=getTagValueFunction(getComponentOrScrollable(component));fun.current=component;if(_reactNative.Platform.OS==='ios'&&!global._IS_FABRIC){var _component$viewConfig;viewName.value=(component===null||component===void 0?void 0:(_component$viewConfig=component.viewConfig)===null||_component$viewConfig===void 0?void 0:_component$viewConfig.uiViewClassName)||'RCTView';}}return tag.value;};fun.current=null;var remoteRef=(0,_shareables.makeShareableCloneRecursive)({__init:function(){var anonymous=function anonymous(){var f=function f(){return tag.value;};f.viewName=viewName;return f;};anonymous.__closure={tag:tag,viewName:viewName};anonymous.__initData=_worklet_10709902486534_init_data;anonymous.__workletHash=10709902486534;return anonymous;}()});(0,_shareables.registerShareableMapping)(fun,remoteRef);ref.current=fun;}return ref.current;}","map":{"version":3,"names":["_react","require","_useSharedValue","_fabricUtils","_shareables","_reactNative","getComponentOrScrollable","component","global","_IS_FABRIC","getNativeScrollRef","getScrollableNode","getTagValueFunction","getShadowNodeWrapperFromRef","findNodeHandle","_worklet_10709902486534_init_data","code","useAnimatedRef","tag","useSharedValue","viewName","ref","useRef","current","fun","value","Platform","OS","_component$viewConfig","viewConfig","uiViewClassName","remoteRef","makeShareableCloneRecursive","__init","anonymous","f","__closure","__initData","__workletHash","registerShareableMapping"],"sources":["/Users/shayan/workspace/godfather/node_modules/react-native-reanimated/lib/module/reanimated2/hook/useAnimatedRef.ts"],"sourcesContent":["import type { Component } from 'react';\nimport { useRef } from 'react';\nimport { useSharedValue } from './useSharedValue';\nimport type { AnimatedRef } from './commonTypes';\nimport type { ShadowNodeWrapper } from '../commonTypes';\nimport { getShadowNodeWrapperFromRef } from '../fabricUtils';\nimport {\n  makeShareableCloneRecursive,\n  registerShareableMapping,\n} from '../shareables';\nimport { Platform, findNodeHandle } from 'react-native';\n\ninterface MaybeScrollableComponent extends Component {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getNativeScrollRef?: any;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getScrollableNode?: any;\n  viewConfig?: {\n    uiViewClassName?: string;\n  };\n}\n\nfunction getComponentOrScrollable(component: MaybeScrollableComponent) {\n  if (global._IS_FABRIC && component.getNativeScrollRef) {\n    return component.getNativeScrollRef();\n  } else if (!global._IS_FABRIC && component.getScrollableNode) {\n    return component.getScrollableNode();\n  }\n  return component;\n}\n\nconst getTagValueFunction = global._IS_FABRIC\n  ? getShadowNodeWrapperFromRef\n  : findNodeHandle;\n\nexport function useAnimatedRef<\n  T extends MaybeScrollableComponent\n>(): AnimatedRef<T> {\n  const tag = useSharedValue<number | ShadowNodeWrapper | null>(-1);\n  const viewName = useSharedValue<string | null>(null);\n\n  const ref = useRef<AnimatedRef<T>>();\n\n  if (!ref.current) {\n    const fun: AnimatedRef<T> = <AnimatedRef<T>>((component) => {\n      // enters when ref is set by attaching to a component\n      if (component) {\n        tag.value = getTagValueFunction(getComponentOrScrollable(component));\n        fun.current = component;\n        // viewName is required only on iOS with Paper\n        if (Platform.OS === 'ios' && !global._IS_FABRIC) {\n          viewName.value = component?.viewConfig?.uiViewClassName || 'RCTView';\n        }\n      }\n      return tag.value;\n    });\n\n    fun.current = null;\n\n    const remoteRef = makeShareableCloneRecursive({\n      __init: () => {\n        'worklet';\n        const f = () => tag.value;\n        f.viewName = viewName;\n        return f;\n      },\n    });\n    registerShareableMapping(fun, remoteRef);\n    ref.current = fun;\n  }\n\n  return ref.current;\n}\n"],"mappings":"+FACA,IAAAA,MAAA,CAAAC,OAAA,UACA,IAAAC,eAAA,CAAAD,OAAA,qBAGA,IAAAE,YAAA,CAAAF,OAAA,mBACA,IAAAG,WAAA,CAAAH,OAAA,kBAIA,IAAAI,YAAA,CAAAJ,OAAA,iBAYA,QAAS,CAAAK,wBAAwBA,CAACC,SAAmC,CAAE,CACrE,GAAIC,MAAM,CAACC,UAAU,EAAIF,SAAS,CAACG,kBAAkB,CAAE,CACrD,MAAO,CAAAH,SAAS,CAACG,kBAAkB,EAAE,CACvC,CAAC,IAAM,IAAI,CAACF,MAAM,CAACC,UAAU,EAAIF,SAAS,CAACI,iBAAiB,CAAE,CAC5D,MAAO,CAAAJ,SAAS,CAACI,iBAAiB,EAAE,CACtC,CACA,MAAO,CAAAJ,SAAS,CAClB,CAEA,GAAM,CAAAK,mBAAmB,CAAGJ,MAAM,CAACC,UAAU,CACzCI,wCAA2B,CAC3BC,2BAAc,KAAAC,iCAAA,EAAAC,IAAA,iIAEX,QAAS,CAAAC,cAAcA,CAAA,CAEV,CAClB,GAAM,CAAAC,GAAG,CAAG,GAAAC,8BAAc,EAAoC,CAAC,CAAC,CAAC,CACjE,GAAM,CAAAC,QAAQ,CAAG,GAAAD,8BAAc,EAAgB,IAAI,CAAC,CAEpD,GAAM,CAAAE,GAAG,CAAG,GAAAC,aAAM,GAAkB,CAEpC,GAAI,CAACD,GAAG,CAACE,OAAO,CAAE,CAChB,GAAM,CAAAC,GAAmB,CAAqB,QAAxC,CAAAA,GAAmBA,CAAqBjB,SAAS,CAAK,CAE1D,GAAIA,SAAS,CAAE,CACbW,GAAG,CAACO,KAAK,CAAGb,mBAAmB,CAACN,wBAAwB,CAACC,SAAS,CAAC,CAAC,CACpEiB,GAAG,CAACD,OAAO,CAAGhB,SAAS,CAEvB,GAAImB,qBAAQ,CAACC,EAAE,GAAK,KAAK,EAAI,CAACnB,MAAM,CAACC,UAAU,CAAE,KAAAmB,qBAAA,CAC/CR,QAAQ,CAACK,KAAK,CAAG,CAAAlB,SAAS,SAATA,SAAS,kBAAAqB,qBAAA,CAATrB,SAAS,CAAEsB,UAAU,UAAAD,qBAAA,iBAArBA,qBAAA,CAAuBE,eAAe,GAAI,SAAS,CACtE,CACF,CACA,MAAO,CAAAZ,GAAG,CAACO,KAAK,CAClB,CAAE,CAEFD,GAAG,CAACD,OAAO,CAAG,IAAI,CAElB,GAAM,CAAAQ,SAAS,CAAG,GAAAC,uCAA2B,EAAC,CAC5CC,MAAM,gBAAAC,SAAA,UAAAA,UAAA,CAAQ,CAEZ,GAAM,CAAAC,CAAC,CAAG,QAAJ,CAAAA,CAACA,CAAA,QAAS,CAAAjB,GAAG,CAACO,KAAK,GACzBU,CAAC,CAACf,QAAQ,CAAGA,QAAQ,CACrB,MAAO,CAAAe,CAAC,CACV,EAAAD,SAAA,CAAAE,SAAA,EAAAlB,GAAA,CA/DGA,GAAA,CAAAE,QAAA,CAGAA,QAAA,EAAAc,SAAA,CAAAG,UAAA,CAAAtB,iCAAA,CAAAmB,SAAA,CAAAI,aAAA,uBAAAJ,SAAA,IA6DL,CAAC,CAAC,CACF,GAAAK,oCAAwB,EAACf,GAAG,CAAEO,SAAS,CAAC,CACxCV,GAAG,CAACE,OAAO,CAAGC,GAAG,CACnB,CAEA,MAAO,CAAAH,GAAG,CAACE,OAAO,CACpB"},"metadata":{},"sourceType":"script","externalDependencies":[]}