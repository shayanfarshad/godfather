{"ast":null,"code":"Object.defineProperty(exports,\"__esModule\",{value:true});exports.getValueUnpackerCode=getValueUnpackerCode;var _PlatformChecker=require(\"./PlatformChecker\");var IS_NATIVE=!(0,_PlatformChecker.shouldBeUseWeb)();var _worklet_7895646787503_init_data={code:\"function valueUnpacker(objectToUnpack,category){let workletsCache=global.__workletsCache;let handleCache=global.__handleCache;if(workletsCache===undefined){workletsCache=global.__workletsCache=new Map();handleCache=global.__handleCache=new WeakMap();}const workletHash=objectToUnpack.__workletHash;if(workletHash!==undefined){let workletFun=workletsCache.get(workletHash);if(workletFun===undefined){const initData=objectToUnpack.__initData;if(global.evalWithSourceMap){workletFun=global.evalWithSourceMap('('+initData.code+'\\\\n)',initData.location,initData.sourceMap);}else if(global.evalWithSourceUrl){workletFun=global.evalWithSourceUrl('('+initData.code+'\\\\n)',\\\"worklet_\\\"+workletHash);}else{workletFun=eval('('+initData.code+'\\\\n)');}workletsCache.set(workletHash,workletFun);}const functionInstance=workletFun.bind(objectToUnpack);objectToUnpack._recur=functionInstance;return functionInstance;}else if(objectToUnpack.__init){let value=handleCache.get(objectToUnpack);if(value===undefined){value=objectToUnpack.__init();handleCache.set(objectToUnpack,value);}return value;}else if(category==='RemoteFunction'){const fun=function(){throw new Error(\\\"[Reanimated] Tried to synchronously call a non-worklet function on the UI thread.\\\\nSee `https://docs.swmansion.com/react-native-reanimated/docs/guides/troubleshooting#tried-to-synchronously-call-a-non-worklet-function-on-the-ui-thread` for more details.\\\");};fun.__remoteFunction=objectToUnpack;return fun;}else{throw new Error('[Reanimated] Data type not recognized by value unpacker.');}}\"};var valueUnpacker=function(){var valueUnpacker=function valueUnpacker(objectToUnpack,category){var workletsCache=global.__workletsCache;var handleCache=global.__handleCache;if(workletsCache===undefined){workletsCache=global.__workletsCache=new Map();handleCache=global.__handleCache=new WeakMap();}var workletHash=objectToUnpack.__workletHash;if(workletHash!==undefined){var workletFun=workletsCache.get(workletHash);if(workletFun===undefined){var initData=objectToUnpack.__initData;if(global.evalWithSourceMap){workletFun=global.evalWithSourceMap('('+initData.code+'\\n)',initData.location,initData.sourceMap);}else if(global.evalWithSourceUrl){workletFun=global.evalWithSourceUrl('('+initData.code+'\\n)',\"worklet_\"+workletHash);}else{workletFun=eval('('+initData.code+'\\n)');}workletsCache.set(workletHash,workletFun);}var functionInstance=workletFun.bind(objectToUnpack);objectToUnpack._recur=functionInstance;return functionInstance;}else if(objectToUnpack.__init){var value=handleCache.get(objectToUnpack);if(value===undefined){value=objectToUnpack.__init();handleCache.set(objectToUnpack,value);}return value;}else if(category==='RemoteFunction'){var fun=function fun(){throw new Error(\"[Reanimated] Tried to synchronously call a non-worklet function on the UI thread.\\nSee `https://docs.swmansion.com/react-native-reanimated/docs/guides/troubleshooting#tried-to-synchronously-call-a-non-worklet-function-on-the-ui-thread` for more details.\");};fun.__remoteFunction=objectToUnpack;return fun;}else{throw new Error('[Reanimated] Data type not recognized by value unpacker.');}};valueUnpacker.__closure={};valueUnpacker.__initData=_worklet_7895646787503_init_data;valueUnpacker.__workletHash=7895646787503;return valueUnpacker;}();if(__DEV__&&IS_NATIVE){if(!('__workletHash'in valueUnpacker)){throw new Error('[Reanimated] `valueUnpacker` is not a worklet');}var closure=valueUnpacker.__closure;if(closure!==undefined&&Object.keys(closure).length!==0){throw new Error('[Reanimated] `valueUnpacker` must have empty closure');}}function getValueUnpackerCode(){return valueUnpacker.__initData.code;}","map":{"version":3,"names":["_PlatformChecker","require","IS_NATIVE","shouldBeUseWeb","_worklet_7895646787503_init_data","code","valueUnpacker","objectToUnpack","category","workletsCache","global","__workletsCache","handleCache","__handleCache","undefined","Map","WeakMap","workletHash","__workletHash","workletFun","get","initData","__initData","evalWithSourceMap","location","sourceMap","evalWithSourceUrl","eval","set","functionInstance","bind","_recur","__init","value","fun","Error","__remoteFunction","__closure","__DEV__","closure","Object","keys","length","getValueUnpackerCode"],"sources":["/Users/shayan/workspace/godfather/node_modules/react-native-reanimated/lib/module/reanimated2/valueUnpacker.ts"],"sourcesContent":["import { shouldBeUseWeb } from './PlatformChecker';\nimport type { WorkletFunction } from './commonTypes';\n\nconst IS_NATIVE = !shouldBeUseWeb();\n\nfunction valueUnpacker(objectToUnpack: any, category?: string): any {\n  'worklet';\n  let workletsCache = global.__workletsCache;\n  let handleCache = global.__handleCache;\n  if (workletsCache === undefined) {\n    // init\n    workletsCache = global.__workletsCache = new Map();\n    handleCache = global.__handleCache = new WeakMap();\n  }\n  const workletHash = objectToUnpack.__workletHash;\n  if (workletHash !== undefined) {\n    let workletFun = workletsCache.get(workletHash);\n    if (workletFun === undefined) {\n      const initData = objectToUnpack.__initData;\n      if (global.evalWithSourceMap) {\n        // if the runtime (hermes only for now) supports loading source maps\n        // we want to use the proper filename for the location as it guarantees\n        // that debugger understands and loads the source code of the file where\n        // the worklet is defined.\n        workletFun = global.evalWithSourceMap(\n          '(' + initData.code + '\\n)',\n          initData.location,\n          initData.sourceMap\n        ) as (...args: any[]) => any;\n      } else if (global.evalWithSourceUrl) {\n        // if the runtime doesn't support loading source maps, in dev mode we\n        // can pass source url when evaluating the worklet. Now, instead of using\n        // the actual file location we use worklet hash, as it the allows us to\n        // properly symbolicate traces (see errors.ts for details)\n        workletFun = global.evalWithSourceUrl(\n          '(' + initData.code + '\\n)',\n          `worklet_${workletHash}`\n        ) as (...args: any[]) => any;\n      } else {\n        // in release we use the regular eval to save on JSI calls\n        // eslint-disable-next-line no-eval\n        workletFun = eval('(' + initData.code + '\\n)') as (\n          ...args: any[]\n        ) => any;\n      }\n      workletsCache.set(workletHash, workletFun);\n    }\n    const functionInstance = workletFun.bind(objectToUnpack);\n    objectToUnpack._recur = functionInstance;\n    return functionInstance;\n  } else if (objectToUnpack.__init) {\n    let value = handleCache!.get(objectToUnpack);\n    if (value === undefined) {\n      value = objectToUnpack.__init();\n      handleCache!.set(objectToUnpack, value);\n    }\n    return value;\n  } else if (category === 'RemoteFunction') {\n    const fun = () => {\n      throw new Error(`[Reanimated] Tried to synchronously call a non-worklet function on the UI thread.\nSee \\`https://docs.swmansion.com/react-native-reanimated/docs/guides/troubleshooting#tried-to-synchronously-call-a-non-worklet-function-on-the-ui-thread\\` for more details.`);\n    };\n    fun.__remoteFunction = objectToUnpack;\n    return fun;\n  } else {\n    throw new Error('[Reanimated] Data type not recognized by value unpacker.');\n  }\n}\n\ntype ValueUnpacker = WorkletFunction<\n  [objectToUnpack: any, category?: string],\n  any\n>;\n\nif (__DEV__ && IS_NATIVE) {\n  if (!('__workletHash' in valueUnpacker)) {\n    throw new Error('[Reanimated] `valueUnpacker` is not a worklet');\n  }\n  const closure = (valueUnpacker as ValueUnpacker).__closure;\n  if (closure !== undefined && Object.keys(closure).length !== 0) {\n    throw new Error('[Reanimated] `valueUnpacker` must have empty closure');\n  }\n}\n\nexport function getValueUnpackerCode() {\n  return (valueUnpacker as ValueUnpacker).__initData.code;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}